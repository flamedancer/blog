---
layout: post
title: 基本系统组成
categories: [计算机组成]
---

----



# 基本系统组成

1. 计算机是由处理器，存储器，输入输出组成的内部互连系统。

2. 总线包括cpu外：连接cpu存储器和输入输出。cpu内：连接cpu各部分，如：控制器，ALU，寄存器。  
	控制器：从主存读取指令，确定指令类型。    
	算术逻辑单元：通过完成加法，逻辑与运算来实现指令。  
	一些寄存器：存放中间结果和控制信息。如：
	* PC(program Counter)。 没有任何“计数”功能的程序计数器。它只是指向下一跳将要被取出执行的指令。
	* 指令寄存器。存放当前被执行的指令。

3. 指令
	1. 指令分为：
		* 寄存器-寄存器指令。例如将两个寄存器送入ALU，进行“加”或“与”运算后，输出到其中一个寄存器。
		* 寄存器-内存指令。例如：内存中字取到寄存器中，或寄存器字写入内存。
	2. 数据通路周期： ALU将两个数据运算并将结果存回的过程称为数据通路周期，是cpu的核心。数据通路越短，运行速度越快。
	3. 指令执行的基本过程 取指-译码-执行循环，是操作系统的核心：
		1. 从内存中取下一条指令到指令寄存器中。
		2. 将程序计数器指向后面一条指令。
		3. 判断取出来的指令类型。
		4. 若该指令用到内存单元，则对内存单元进行寻址。
		5. 从内存中取到一个字到寄存器。
		6. 执行指令
		7. 返回到第1步
	4. 复杂指令与精简指令
		1. 复杂指令计算机CISC(Complex Instruction Set Computer)。
			* 指令执行策略：采用一个解释器，将复杂指令分解为多个解释器指令，即 微指令。
			* 优点： 复杂指令性能优势在于，执行分解后的微指令有时是可以重叠的，或用不同的硬件并线执行。
			* 弊端： 指令集比较大。
			* 代表产品： Intel Pentiunm, IBM大型机。
		2. 精简指令计算机RISC(Reduced Instruction Set Computer).
			* 指令执行策略： 指令都是可以直接用硬件直接执行的。
			* 优点： 指令集小；  
			        虽然要4~5个指令才能完成CISC一条指令的功能，但不要解析执行的额外消耗。
			* 代表产品： SUN的ULTRASPARC
		3. 谁占优？   
		   理论上RISC性能会更好。但市场早已被Intel占领。此外Intel还采用了改进的混合方案，从80846开始，最简单的指令能在一个数据通路完成，而复杂的指令原用CISC办法执行。
	5. 指令级并行。
		1. 指令流水线： 将指令执行的多个子过程，每个子过程由硬件分别执行，想象工厂的流水线即可。
		2. 多流水线技术，即多条流水线。  
		   Intel 80486有两条流水线，主流水线(u流水线）可以执行所有的Pentium 指令。副流水线（v流水线）只能执行简单的整数指令。
		3. 超标量体系结构：只有一条流水线，但一个只过程可能被反向代理成多个不同的功能单元执行。
	6. 处理器级并行
		* 阵列计算机
			1. 阵列处理器。由许多在不同数据集合上执行相同指令序列完全相同的处理器组成。（想象成广播体操？）
			2. 向量处理器和阵列处理器类似，只是加法运算由一个单独的加法器实现。将数据串行装入向量寄存器中，再流水进入加法器，执行加法运算，得到结果向量后写回向量寄存器或再进行一次向量运算。
			3. 因为是共享一个控制器，，所以阵列处理器上的处理单元称不上独立的cpu。
		* 多处理器
			1. 真正的多cpu
			2. 通过局本部内存或高数cache技术减少总线压力
		* 多计算器

4. 主存储器（内存）
	1. 物理上，数字信号通过电压的高低或电流的大小等来区分。采用二进制是因为它最有效，最可靠。要区分的值越多，相邻的值差别就越小，可靠性就越低。而二进制只要区分两个值。
	2. 最小的编址单元称为存储单元。大部分的制造商都标准化为8位的存储单元，即 字节。
	3. 字节再组合成字。32为计算机每个字有4字节。64位计算机字有8字节。
	4. 大多数指令是对字进行操作的。也就是说32为计算机的寄存器为32位，指令的操作对象为32位。
	5. （不是很懂）字节顺序。大端小端，在存储器物理上相同，每个数据位放的数据都是一样的，只是在逻辑上，对字节的编号不同。
	6. （实现原理没深究，看不懂）纠错码，防止内存出错。
	7. 高速缓存cache(发音cash)
		1. 局部性原理：在单位时间片内，cpu对存储器的访问总是局限在整个存储器的一小部分中。它是cache的原理基础。
		2. 以局部性原理为基础，把主存和高速缓存分为固定大小的块，称为cache块。当访问高速缓存失败时，整个cache块被主存装入，不仅仅是被访问的那个字。
		3. 要解决关于高速缓存的5个问题。
			1. 高速缓存容量与成本的矛盾
			2. 如何划分高速缓存块的大小
			3. 高速缓存字如何和主存相对应
			4. 整体缓存还是用分体缓存（指令和数据分开缓存-哈弗结构）
			5. 高速缓存的个数
	8. 内存条的封装
		* 早期内存是以芯片为单位制作的，内存槽用来插入存储器芯片。
		* 现在把8或16块芯片装在一块电路板上。根据连线分为单面接入内存条SIMM（Single Inline Memory Module) 和双面接入内存条DIMM（Dual Inline Memory Module)
5. 辅存
	1. 磁盘
		1. 磁盘由n个涂有磁性材料的铝质浅盘组成，直径大概3~12cm，笔记本约为3cm以下。
		2. 磁盘和磁头隔着空气垫。当磁头有电流通过时，可以磁化下方的磁盘，使磁性颗粒向左或向右偏移。当磁头通过磁性区域时，，将被感应出正电流或负电流，就可以读出磁盘数据。使磁盘在磁头下高速旋转，，就可以读出或写入磁盘数据。
		3. 格式化：磁道可以分为多个扇区，每个扇区依次分为前导区-数据区-纠错区。每个扇区由隔离带隔开。这是磁盘可用容量比物理容量少的原因。
		4. 许多磁盘是由多块铝块叠起来的。每个磁头表面都有自己的磁头和磁盘臂。所有磁盘臂连在一起。
		5. 同一半径的磁道的集合称为柱面。
		6. 影响磁盘性能的因素。
			* 寻道延迟：将磁盘臂移动到相应半径的时间。
			* 旋转延迟：相应扇区移动到磁头下方的时间
		7. 磁盘控制器的功能
			1. 执行READ，WRITE，FORMAT命令
			2. 控制磁盘臂移动
			3. 发现和纠正错误
			4. 将内存8位字节转化位串写入磁盘或相反
			5. 扇区缓存
			6. 重新映像坏扇区（被永久磁化的扇区）（用预留的空扇区替换坏扇区）
		8. BIOS（Basic Input Output System），PC机内置只读存储器内的基础输入输出系统
		9. 调用磁盘的基本步骤：
			1. 操作系统将参数（磁头扇区柱面等）写入cpu寄存器后
			2. 调用pc内置只读存储器内的BIOS对硬盘读写
			3. 由BIOS发出机器指令，指示硬盘控制器传输数据
			4. 控制器对驱动发出寻道及其他指令
			5. 磁头定位到相应磁道和扇区后
			6. 驱动器以位流的形式往控制器传输数据
			7. 控制器将位流打包成组直接写入内存（直接内存访问DMA Direct Memory Access）
			8. 数据传送结束后，控制器发出中断请求，要求cpu挂起当前运行的程序并启动一个叫中断处理的特定过程，检查此次读写是否有错误，完成必要处理，通知操作系统当前的输入/输出结果
			9. 中断过程完成后，cpu出断点继续执行被挂起的程序


	2. 软盘  
        工作原理和磁盘类似，只是磁头是和盘面直接接触的，没有空气垫。所以磁介质和磁头都磨损的快，为减少磨损，再不进行读写时，PC机将收回磁头，并停止盘面旋转。这导致下一个条读写命令来时，需要半秒的延迟来启动马达和达到需要的转速。
	3. IDE
		1. 硬盘最早是由IBM放入10MB Seagate发展而来的，控制器是Xebec控制器，有独立的硬盘卡
		2. 控制器有独立的硬盘卡发展为和驱动器集成一起，组成驱动电路IDE(Integrated Drive Electronic).但任然是通过给BIOS传递磁头号（4位），柱面号（10位），扇区号（6位）对扇区进行寻址。
		3. 由于磁盘容量增加，BIOS参数范围出现局限（例如有2000个柱面时，10位的柱面号就无能为力）。解决办法为对参数进行重新映射（例如用扇区号255 柱面号1023来袋面第2000个柱面）。
		4. 有IDE盘发展了EIDE盘，它支持另一种地址映射方法，逻辑块寻址LBA（logical Block Addressing).它将扇区号扩展到0~2**（28-1），要求控制器将LBA转换为相应的磁头，扇区和柱面
		5. 28为LBA的128GB限制日益不满足需要。ATAPI-6将LBA大小改成为48位。
	4. SCSI盘
		* 在柱面磁道扇区组织方面和IDE无区别。但它接口不同，传输效率更高
	6. RAID 盘  
	    廉价磁盘冗余阵列RAID(Redundant Arrary Of Inexpensive Disk).用特定的磁盘组织来提高磁盘性能和可靠性。
		1. RAID0， 将块分到n个数据带中。当读写块数据时，将使n个磁盘驱动器读写数据。安全性低，坏一个盘，全坏。
		2. RAID1，所有盘数据相同。读时可以负载均衡到多个盘，但写时要写多次，安全性高，有多个备份，单冗余过高。
		3. RAID2，将字加上多个校验位后，每个位分别写入到不同驱动器。可以在一个扇区时间内完成n个扇区的数据读写。安全性高，因为有校验位，但对驱动器数量要求大，而且要求所有驱动器同步旋转。
		4. RAID3是RAID2的简化版，只有一位校验位。
		5. RAID4,为RAID0加上校验位，提高安全性，校验位写在一个单独的驱动器上。可靠性得到保障，但纠错效率低，因为算法复杂，且要读出所有盘数据才能算出出错信息。
		6. RAID5，为了减少RAID4校验盘的负载，将校验信息分布到所有驱动器。但任然没有解决纠错过于复杂的问题。

	7. 光盘
		* CD, CD-ROM, CD-RW
		* DVD
		* 蓝光 Blu-Ray
	8. 总线
		* PCI
		* ISA
	9. 终端设备
	10. 字符集
		1. 美国信息交换编码标准ASCII （American Standard Code for Information Interchange)
		2. UNICODE
			* 用来同意全球的文字编码
			* 分为 UCS-2或称Unicode16，用两2字节编码，65536（2^7)个码点
			* UCS-4或称Unicode32，用两4字节编码， 有2^31个码点
		3. UTF-8
			* UTF 全称为UCS转换格式（UCS Transformation Format)，它是将Unicode编码规则和计算机实际编码对应起来的一个映射规则。
			* unicode是双字节的，而ASCII是单字节的，以前处理ACSII的机制失效
			* c语言用'\0'做为字符串结尾，而unicode很多字符就是以'\0'结尾的